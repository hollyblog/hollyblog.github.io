---
title: "Java 数组"
date: 2021-01-09T20:18:05+08:00
draft: false
description: "Java 数组：数组基础、多维数组、数组操作。"
tags: ["Java", "数组"]
categories: ["Java"]
---
Java 数组：数组基础、多维数组、数组操作。
## 数组基础
### 数组的特点
- 类型统一：数组中所有的元素都是相同的数据类型。
- 长度固定：数组的长度在创建后不能改变。
- 索引访问：数组中的每个元素都有一个唯一的索引，用于访问和操作该元素。
- 连续存储：数组中的元素在内存中是连续存储的，每个元素的内存地址都可以通过数组的基地址和索引计算得到。
### 数组的声明
> 数组声明时不能指定长度，长度是在创建数组时确定的，例如`int[5] arr;`是错误的用法。
### 数组访问越界异常
数组访问越界异常是指在访问数组元素时，使用了超出数组有效索引范围的索引。数组有效索引是 0～length-1，如果使用了超出这个范围的索引，就会抛出数组访问越界异常`ArrayIndexOutOfBoundsException`。
### 数组内存模型
```java
// 数组内存模型
int[] arr = new int[]{10,20,30};
//栈内存：数组变量arr存储数组对象的地址；
//堆内存：数组对象存储在堆内存中，每个元素占用4个字节（int类型），数组的长度是3，所以占用12个字节。
```
## 多维数组
Java中的多维数组是指数组的数组，而不是真正的多维数组，这意味着每一行都可以有不同的长度，形成不规则数组。每一行数组可能存储在不同的位置。

> 使用不规则数组时，要特别注意每一行的长度不同，避免数组越界异常，始终使用`array[i].length`来获取第i行的长度。

最佳实践
- 合理选择维度：根据实际需求选择合适的维度，避免过度复杂化；
- 初始化时指定大小：提前知道大小时，一次性分配内存；
- 使用增强for循环：遍历时优先使用增强for循环，简洁易读；
- 手动管理索引：在需要手动管理索引的情况下，使用普通for循环，避免使用增强for循环。
- 边界检查：访问数组元素前，进行边界检查，避免数组越界异常。
- 缓存数组长度：在需要多次访问数组长度的情况下，将数组长度缓存到一个变量中，避免每次都访问数组属性。

## 数组操作
包括数组复制、数组排序、数组遍历、数组搜索等操作。

### 性能优化建议
- 大数组复制：使用`System.arraycopy()`方法复制大数组，而不是使用普通的for循环复制，因为`System.arraycopy()`方法是一个本地方法，执行效率更高。
- Arrays.copyOf()：使用`Arrays.copyOf()`方法复制数组，处理常规需求，因为`Arrays.copyOf()`方法更简洁易读。
- 数组排序：使用`Arrays.sort()`方法对数组进行排序，而不是使用冒泡排序等简单排序算法，因为`Arrays.sort()`方法是一个本地方法，执行效率更高。
- 频繁搜索时先排序再使用二分搜索：如果需要频繁搜索数组中的元素，先对数组进行排序，然后使用二分搜索算法进行搜索，因为二分搜索算法的时间复杂度是O(log n)，而简单搜索算法的时间复杂度是O(n)。
- 根据数据规模选择合适算法。
### 数组操作的实际应用
- 学生成绩管理：复制备份数据、排序计算排名、搜索特定学生；
- 销售数据分析：处理销售数据、排序找出趋势、搜索异常数据；
- 游戏排行榜：排序玩家分数、快速查找玩家排名；
- 库存管理系统：排序商品、搜索特定商品、复制历史数据；
- 日志分析：排序日志条目、搜索错误信息、备份重要数据。
### 性能注意
- 大数据集操作时要特别注意算法的时间复杂度
- 频繁的数据操作可能会导致内存碎片，考虑使用集合类
- 多线程环境下要注意数组操作的线程安全性；
- 对于超大数据，考虑分批处理或者使用流式处理。